{% extends 'base.html' %}
{% block title %}Audit Logs{% endblock %}
{% block content %}
<h2 class="mb-3">Audit Logs (Tamper-Evident Chain)</h2>
<div class="card p-3">
  <div class="table-responsive">
    <table class="table table-dark table-striped table-sm">
      <thead>
        <tr>
          <th>Time</th><th>Actor</th><th>Action</th><th>Entity</th><th>Entity ID</th><th>Prev Hash</th><th>Hash</th>
        </tr>
      </thead>
      <tbody>
      {% for r in rows %}
        <tr>
          <td>{{ r.timestamp }}</td>
          <td>{{ r.actor_name or 'System' }}</td>
          <td>{{ r.action }}</td>
          <td>{{ r.entity_type }}</td>
          <td>{{ r.entity_id }}</td>
          <td class="small">{{ (r.prev_hash or '-')[:12] }}...</td>
          <td class="small">{{ (r.hash or '-')[:12] }}...</td>
        </tr>
      {% else %}
        <tr><td colspan="7" class="text-center">No logs.</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}

